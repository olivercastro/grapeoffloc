<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2011 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php $_product = $this->getProduct(); ?>
<?php $c_custid=Mage::getSingleton('customer/session')->getCustomer()->getId();
			$query_c="select typecust from customer_entity where entity_id='".$c_custid."'";
			$cdetails=Mage::getSingleton('core/resource') ->getConnection('core_read')->fetchRow($query_c);  ?>
<?php $buttonTitle = $this->__('Add to Cart'); ?>
 <?php
$cart = Mage::getModel('checkout/cart')->getQuote()->getData();

$qtyStock = Mage::getModel('cataloginventory/stock_item')->loadByProduct($_product)->getQty();


?>
<?php if($_product->isSaleable()): ?>
    <div class="add-to-cart">
        <?php if(!$_product->isGrouped()): ?>
	<input type="hidden" id="txt_cartqty" name="txt_cartqty" value="<?php if(isset($cart['items_qty'])){
echo (int)$cart['items_qty'];
}  ?>"/>
<input type="hidden" id="txt_prodqty" name="txt_prodqty" value="<?php echo round($qtyStock); ?>"/>
        <label for="qty"><?php echo $this->__('Qty:') ?></label>
        <input type="text" name="qty" id="qty" maxlength="12" value="<?php echo $this->getProductDefaultQty() * 1 ?>" title="<?php echo $this->__('Qty') ?>" class="input-text qty" />
        <?php endif; ?>
	 <?php   if($cdetails['typecust']==1)
		  { ?>
        <button type="button" title="<?php echo $buttonTitle ?>" class="button btn-cart" onclick="alert('Vendor is not allowed to purchase the product!');"><span><span><?php echo $buttonTitle ?></span></span></button>
	<?php } else { ?>
	 <button type="button" title="<?php echo $buttonTitle ?>" class="button btn-cart" onclick="productAddToCartForm.submit(this)"><span><span><?php echo $buttonTitle ?></span></span></button>
	<?php } ?>
        <?php echo $this->getChildHtml('', true, true) ?>
	
    </div>
<?php endif; ?>
<!--<script type="text/javascript">
	jQuery(document).ready(function() {
		var cqty=jQuery('#txt_cartqty').val();
		var pqty=jQuery('#txt_prodqty').val();
		var qty=jQuery('#qty').val();
		var sp=jQuery('.error-msg span').html().split('"');
		//alert(sp[0]);
		//alert(cqty+"="+pqty);
		if(cqty==pqty)
		{
			jQuery('.error-msg span').html('The maximum permissible quantity as per current stock level is '+pqty+' only. You already have the quantity ('+cqty+') for this product in your cart, please visit My Cart for further decision on your requested purchase.');	
			//alert('123');
		}
		else if(sp[0]=='The requested quantity for ' && cqty>0)
		{
			jQuery('.error-msg span').html('The maximum permissible quantity as per current stock level is '+pqty+' only. You already have the quantity ('+cqty+') for this product in your cart, please visit My Cart for further decision on your requested purchase.');
		}
		else
		{
			jQuery('.error-msg span').html('The maximum permissible quantity as per current stock level is '+pqty+' only.');
		}
	
	});
</script>-->
